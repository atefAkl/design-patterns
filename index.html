<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الدليل التفاعلي لأنماط التصميم</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: A single-page application with a tab-based navigation for the three main pattern categories (Creational, Structural, Behavioral). Clicking a category reveals its patterns. Selecting a pattern displays its details, including a description, use case, and a unique interactive visualization/example. This structure is chosen to allow non-linear, focused learning, letting users jump to any pattern of interest easily, enhancing engagement over a simple text document. -->
    <!-- Visualization & Content Choices: Content is from the lecture outline. Each pattern is presented with its goal, idea, and an interactive element to demonstrate its function. For example, the Decorator pattern uses a coffee-building interface, and the Strategy pattern uses a shipping calculator. These interactive choices make abstract concepts tangible. Diagrams are built with styled HTML divs. Chart.js is not needed. All interactions are handled with vanilla JavaScript. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #FDFBF7;
            color: #3D352F;
        }
        .tab-active {
            background-color: #D5BBA1;
            color: #FFFFFF;
            font-weight: 700;
        }
        .pattern-active {
            background-color: #EFEBE5;
            border-right: 4px solid #D5BBA1;
        }
        .interactive-box {
            border: 2px dashed #D5BBA1;
            min-height: 200px;
        }
        .btn-primary {
            background-color: #C3A687;
            color: white;
            transition: background-color 0.3s;
        }
        .btn-primary:hover {
            background-color: #B59570;
        }
        .code-block {
            background-color: #EFEBE5;
            border-right: 3px solid #C3A687;
            direction: ltr;
            text-align: left;
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-8 md:mb-12">
            <h1 class="text-3xl md:text-5xl font-bold text-[#A47C57]">الدليل التفاعلي لأنماط التصميم</h1>
            <p class="mt-4 text-lg md:text-xl text-gray-600">استكشف أشهر حلول المشاكل البرمجية بطريقة سهلة وممتعة.</p>
        </header>

        <main>
            <!-- Introduction Section -->
            <section id="introduction" class="bg-white p-6 rounded-lg shadow-md mb-8">
                <h2 class="text-2xl font-bold mb-4 text-[#A47C57]">ما هي أنماط التصميم (Design Patterns)؟</h2>
                <p class="mb-3">هي حلول مجربة ومختبرة لمشاكل برمجية شائعة ومتكررة في تصميم البرمجيات. هي ليست أكواداً جاهزة، بل "قوالب" أو "وصفات" لكيفية تنظيم الكود لحل مشكلة معينة، وهي تمثل خلاصة خبرات المطورين على مر السنين.</p>
                <h3 class="text-xl font-bold mb-2 text-[#A47C57]">لماذا نستخدمها؟</h3>
                <ul class="list-disc pr-5 grid grid-cols-1 md:grid-cols-2 gap-2">
                    <li><span class="font-bold">قابلية إعادة الاستخدام:</span> توفر حلولاً يمكن تطبيقها في سياقات مختلفة.</li>
                    <li><span class="font-bold">قابلية الصيانة:</span> تجعل الكود أسهل في الفهم والتعديل.</li>
                    <li><span class="font-bold">لغة مشتركة:</span> توفر مصطلحات موحدة للمطورين للتواصل حول تصميماتهم.</li>
                    <li><span class="font-bold">تحسين جودة الكود:</span> تساعد في بناء أنظمة قوية، مرنة، وقابلة للتوسع.</li>
                </ul>
            </section>

            <!-- Main Interactive Section -->
            <div class="bg-white p-4 rounded-lg shadow-md">
                <!-- Category Tabs -->
                <nav id="category-tabs" class="flex justify-center border-b-2 border-[#EFEBE5] mb-4">
                    <!-- Tabs will be generated by JS -->
                </nav>

                <div class="grid grid-cols-12 gap-6">
                    <!-- Patterns List -->
                    <aside id="patterns-list" class="col-span-12 md:col-span-3">
                        <!-- List will be generated by JS -->
                    </aside>

                    <!-- Pattern Details -->
                    <section id="pattern-details" class="col-span-12 md:col-span-9">
                         <!-- Initial message -->
                        <div class="flex items-center justify-center h-full bg-gray-50 rounded-lg p-8">
                            <p class="text-gray-500 text-xl">اختر فئة ثم نمطًا من القائمة لعرض تفاصيله.</p>
                        </div>
                    </section>
                </div>
            </div>

            <!-- Conclusion Section -->
            <footer id="conclusion" class="bg-white p-6 rounded-lg shadow-md mt-8">
                <h2 class="text-2xl font-bold mb-4 text-[#A47C57]">لماذا هي مهمة لمسيرتك كمطور؟</h2>
                <p>أنماط التصميم ليست مجرد "كلمات رنانة"، بل هي أدوات قوية في صندوق أدوات أي مطور. تساعدك على كتابة كود أفضل، أكثر مرونة، وأسهل في الصيانة، وتجعلك تفكر في تصميمات قابلة للتوسع من البداية. فهمها يرفع من مستواك ويجعلك جزءاً من مجتمع المطورين العالمي الذي يتحدث نفس اللغة.</p>
                <p class="mt-3 font-bold text-[#A47C57]">نصيحة: ابدأ بتطبيقها في مشاريعك الصغيرة، ومع الممارسة ستصبح جزءاً من تفكيرك البرمجي.</p>
            </footer>
        </main>
    </div>

    <script>
        const designPatternsData = {
            "creational": {
                name: "أنماط الإنشاء (Creational)",
                description: "تتحكم في كيفية وآليات إنشاء الكائنات (Objects)، مما يجعل العملية أكثر مرونة وكفاءة.",
                patterns: {
                    "Singleton (الكائن الوحيد)": {
                        idea: "يضمن وجود نسخة واحدة فقط من كلاس معين في التطبيق، ويوفر نقطة وصول عالمية لهذه النسخة.",
                        use_cases: [
                            "# لإدارة الموارد المشتركة مثل اتصالات قاعدة البيانات، إعدادات التطبيق، أو مدير السجلات (Logger).",
                            "# مدير السجلات (Logger)",
                            "# إعدادات التطبيق (Configuration Manager / Settings)",
                            "# مدير الطباعة (Print Spooler / Printer Manager)",
                            "# مدير التخزين المؤقت (Cache Manager)",
                            "# مدير المهام (Task Manager / Job Queue Manager)",
                        ],
                        interactive_html: `
                            <p class="mb-4">اضغط على الزر عدة مرات. ستلاحظ أن معرّف الكائن (Instance ID) لا يتغير، مما يثبت أنه يتم إرجاع نفس النسخة دائماً.</p>
                            <button id="singleton-btn" class="btn-primary py-2 px-4 rounded-md">الحصول على نسخة قاعدة البيانات</button>
                            <div id="singleton-output" class="mt-4 p-4 bg-gray-100 rounded-lg text-lg font-mono"></div>
                        `,
                        
                        interactive_js: () => {
                            const DatabaseConnection = (function() {
                                let instance;
                                function createInstance() {
                                    const object = new Object({ id: "DB_INSTANCE_" + Math.floor(Math.random() * 1000) });
                                    return object;
                                }
                                return {
                                    getInstance: function() {
                                        if (!instance) {
                                            instance = createInstance();
                                        }
                                        return instance;
                                    }
                                };
                            })();

                            const btn = document.getElementById('singleton-btn');
                            const output = document.getElementById('singleton-output');
                            btn.addEventListener('click', () => {
                                const dbInstance = DatabaseConnection.getInstance();
                                output.textContent = 'Instance ID: ' + dbInstance.id;
                            });
                        }
                    },
                    "Factory Method (طريقة المصنع)": {
                        idea: "يوفر واجهة لإنشاء الكائنات في كلاس أب، لكن يسمح للكلاسات الأبناء بتحديد نوع الكائن الذي سيتم إنشاؤه.",
                        use_cases: [
                            "<b>عندما لا تعرف مسبقاً أي كلاس فرعي ستحتاج لإنشائه، أو عندما تريد تفويض عملية الإنشاء للكلاسات الفرعية.</b>",
                            "# معالجة أنواع مختلفة من المستندات/الملفات (Document/File Processing)",
                            "# أنظمة إدارة قواعد البيانات المتعددة (Database Abstraction Layers)",
                            "# إدارة واجهات المستخدم الرسومية (GUI Frameworks / Widget Creation)",
                            "# ألعاب الفيديو (Game Development - Character/Enemy Creation)",
                            "# أنظمة لوجيستية أو تصنيعية (Logistics/Manufacturing Systems)"
                        ],
                        interactive_html: `
                            <p class="mb-4">اختر نوع مركبة ثم اضغط على "إنشاء" لرؤية الكائن الذي سينتجه المصنع.</p>
                            <select id="factory-select" class="p-2 border rounded-md mb-2">
                                <option value="Car">سيارة 🚗</option>
                                <option value="Motorcycle">دراجة نارية 🏍️</option>
                            </select>
                            <button id="factory-btn" class="btn-primary py-2 px-4 rounded-md">إنشاء مركبة</button>
                            <div id="factory-output" class="mt-4 p-4 bg-gray-100 rounded-lg text-lg"></div>
                        `,
                        interactive_js: () => {
                            const btn = document.getElementById('factory-btn');
                            const select = document.getElementById('factory-select');
                            const output = document.getElementById('factory-output');

                            btn.addEventListener('click', () => {
                                const type = select.value;
                                if (type === 'Car') {
                                    output.innerHTML = 'تم إنشاء كائن: <strong>سيارة</strong>. تحتوي على 4 عجلات وباب.';
                                } else if (type === 'Motorcycle') {
                                    output.innerHTML = 'تم إنشاء كائن: <strong>دراجة نارية</strong>. تحتوي على عجلتين ومقود.';
                                }
                            });
                        }
                    }
                }
            },
            "structural": {
                name: "أنماط الهيكل (Structural)",
                description: "تتعامل مع كيفية تجميع الكائنات والفئات لتشكيل هياكل أكبر وأكثر تعقيداً، وتركز على العلاقات بينها.",
                patterns: {
                    "Adapter (المحوّل)": {
                        idea: "يسمح للكلاسات ذات الواجهات غير المتوافقة بالعمل معاً. يعمل كمترجم بين نظامين مختلفين.",
                        use_cases: [
                            "<b>عندما تريد استخدام كلاس موجود لا يتطابق مع الواجهة المطلوبة، مثل ربط نظام قديم ببوابة دفع جديدة.</b>",
                            "# ربط أنظمة قديمة بأنظمة حديثة (Legacy System Integration)",
                            "# دمج مكتبات طرف ثالث (Third-Party Library Integration)",
                            "# تحويل أنواع البيانات (Data Type Conversion)",
                            "# واجهات المستخدم الرسومية (GUI Frameworks)",
                            "# توفير واجهة موحدة لمصادر بيانات متعددة (Unified Interface for Multiple Data Sources)",
                            ],
                        interactive_html: `
                            <p class="mb-4">تخيل أن لديك قابسًا مربعًا ومنفذًا دائريًا. المحول هو الذي يجعلهما يعملان معًا. اضغط على الزر لاستخدام المحول.</p>
                            <div class="flex items-center justify-around text-center">
                                <div><div class="w-16 h-16 bg-blue-400 rounded-md flex items-center justify-center text-white">نظام قديم</div><p>بيانات XML</p></div>
                                <div id="adapter-arrow" class="text-3xl opacity-0 transition-opacity duration-500">➡️</div>
                                <div id="adapter-element" class="w-20 h-16 bg-green-500 rounded-lg flex items-center justify-center text-white opacity-0 transition-opacity duration-500">المحوّل</div>
                                <div id="adapter-arrow-2" class="text-3xl opacity-0 transition-opacity duration-500">➡️</div>
                                <div><div class="w-16 h-16 bg-red-400 rounded-full flex items-center justify-center text-white">نظام جديد</div><p>بيانات JSON</p></div>
                            </div>
                            <button id="adapter-btn" class="btn-primary py-2 px-4 rounded-md mt-4">استخدام المحوّل</button>
                            <div id="adapter-output" class="mt-4 p-4 bg-gray-100 rounded-lg text-lg"></div>
                        `,
                        interactive_js: () => {
                            const btn = document.getElementById('adapter-btn');
                             btn.addEventListener('click', () => {
                                document.getElementById('adapter-arrow').style.opacity = '1';
                                document.getElementById('adapter-element').style.opacity = '1';
                                 document.getElementById('adapter-arrow-2').style.opacity = '1';
                                document.getElementById('adapter-output').textContent = 'المحوّل قام بتحويل بيانات XML إلى JSON بنجاح!';
                            });
                        }
                    },
                    "Decorator (المُزخرِف)": {
                        idea: "يسمح بإضافة وظائف جديدة إلى كائن موجود ديناميكياً (في وقت التشغيل) دون تعديل هيكله الأصلي.",
                        use_cases: [
                            "</b>عندما تريد إضافة سلوكيات أو مسؤوليات إلى كائنات فردية، أو عندما يكون التوريث غير عملي.</b?",
                            "# أنظمة طلب المشروبات/القهوة (Coffee/Beverage Ordering Systems)",
                            "# إضافة وظائف لتدفقات البيانات (Input/Output Streams in Programming)",
                            "# إدارة الأذونات/الصلاحيات (Permissions/Authorization Management)",
                            "# إضافة ميزات لواجهة المستخدم الرسومية (GUI Component Enhancements)",
                            "# تسجيل الأحداث/التتبع (Logging/Tracing Functionality)",
                        ],
                         interactive_html: `
                            <p class="mb-4">ابدأ بكوب قهوة أساسي، ثم أضف "المُزخرِفات" (حليب وسكر) لرؤية كيف يتغير الوصف والسعر.</p>
                            <button id="decorator-milk-btn" class="btn-primary py-2 px-4 rounded-md mr-2">إضافة حليب</button>
                            <button id="decorator-sugar-btn" class="btn-primary py-2 px-4 rounded-md">إضافة سكر</button>
                            <div id="decorator-output" class="mt-4 p-4 bg-gray-100 rounded-lg">
                                <p><strong>الطلب الحالي:</strong> <span id="deco-desc">قهوة</span></p>
                                <p><strong>السعر:</strong> <span id="deco-price">10</span> جنيه</p>
                            </div>
                        `,
                        interactive_js: () => {
                            let coffee = { price: 10, description: "قهوة" };
                            const milkBtn = document.getElementById('decorator-milk-btn');
                            const sugarBtn = document.getElementById('decorator-sugar-btn');
                            const descEl = document.getElementById('deco-desc');
                            const priceEl = document.getElementById('deco-price');

                            milkBtn.addEventListener('click', () => {
                                if (!coffee.hasMilk) {
                                    coffee.price += 5;
                                    coffee.description += " بالحليب";
                                    coffee.hasMilk = true;
                                    updateDisplay();
                                }
                            });
                             sugarBtn.addEventListener('click', () => {
                                if (!coffee.hasSugar) {
                                    coffee.price += 2;
                                    coffee.description += " والسكر";
                                    coffee.hasSugar = true;
                                    updateDisplay();
                                }
                            });
                             function updateDisplay() {
                                descEl.textContent = coffee.description;
                                priceEl.textContent = coffee.price;
                            }
                        }
                    }
                }
            },
            "behavioral": {
                name: "أنماط السلوك (Behavioral)",
                description: "تتعامل مع كيفية تفاعل الكائنات وتوزيع المسؤوليات فيما بينها، وتركز على أنماط الاتصال بينها.",
                patterns: {
                    "Observer (المُراقِب)": {
                        idea: "يحدد علاقة 'واحد إلى متعدد' بين الكائنات، حيث عندما يتغير حالة كائن (الموضوع)، يتم إعلام جميع الكائنات التابعة له (المراقبون) تلقائياً.",
                        use_case: "عندما تحتاج إلى تحديث العديد من الكائنات بشكل تلقائي عند تغيير حالة كائن واحد، مثل نظام الإشعارات.",
                        interactive_html: `
                            <p class="mb-4">اضغط على زر "نشر المقال" (الموضوع) ولاحظ كيف يتم إعلام جميع المشتركين (المراقبين) تلقائياً.</p>
                            <button id="observer-btn" class="btn-primary py-2 px-4 rounded-md">نشر المقال الجديد</button>
                            <div class="mt-4">
                                <h4 class="font-bold">المشتركون:</h4>
                                <ul id="observer-list" class="list-disc pr-5">
                                    <li data-user="أحمد">أحمد (في انتظار الإشعار)</li>
                                    <li data-user="فاطمة">فاطمة (في انتظار الإشعار)</li>
                                    <li data-user="خالد">خالد (في انتظار الإشعار)</li>
                                </ul>
                            </div>
                        `,
                        interactive_js: () => {
                            const btn = document.getElementById('observer-btn');
                            const list = document.getElementById('observer-list');
                            btn.addEventListener('click', () => {
                                list.querySelectorAll('li').forEach(item => {
                                    item.textContent = `${item.dataset.user} (تم استلام الإشعار ✅)`;
                                    item.classList.add('text-green-600');
                                });
                            });
                        }
                    },
                    "Strategy (الاستراتيجية)": {
                        idea: "يسمح بتحديد مجموعة من الخوارزميات، وتغليف كل واحدة في كلاس منفصل، ثم جعلها قابلة للتبديل في وقت التشغيل.",
                        use_cases: [
                            "عندما يكون لديك عدة طرق مختلفة لأداء نفس المهمة وتريد تبديلها بسهولة، مثل طرق حساب أسعار الشحن.",
                        ],
                         interactive_html: `
                            <p class="mb-4">اختر استراتيجية شحن مختلفة واحسب التكلفة. لاحظ كيف يتغير السعر بناءً على الاستراتيجية المختارة.</p>
                            <select id="strategy-select" class="p-2 border rounded-md mb-2">
                                <option value="Normal">شحن عادي</option>
                                <option value="Express">شحن سريع</option>
                                <option value="International">شحن دولي</option>
                            </select>
                            <button id="strategy-btn" class="btn-primary py-2 px-4 rounded-md">حساب تكلفة الشحن</button>
                            <div id="strategy-output" class="mt-4 p-4 bg-gray-100 rounded-lg text-lg"></div>
                        `,
                        interactive_js: () => {
                            const btn = document.getElementById('strategy-btn');
                            const select = document.getElementById('strategy-select');
                            const output = document.getElementById('strategy-output');
                             btn.addEventListener('click', () => {
                                const strategy = select.value;
                                let price = 0;
                                if (strategy === 'Normal') price = 25;
                                else if (strategy === 'Express') price = 50;
                                else if (strategy === 'International') price = 150;
                                output.innerHTML = `التكلفة باستخدام استراتيجية <strong>${select.options[select.selectedIndex].text}</strong>: ${price} جنيه`;
                            });
                        }
                    }
                }
            }
        };

        const categoryTabsContainer = document.getElementById('category-tabs');
        const patternsListContainer = document.getElementById('patterns-list');
        const patternDetailsContainer = document.getElementById('pattern-details');

        let activeCategory = null;
        let activePattern = null;

        function renderTabs() {
            categoryTabsContainer.innerHTML = '';
            Object.keys(designPatternsData).forEach(category => {
                const tab = document.createElement('button');
                tab.textContent = designPatternsData[category].name;
                tab.className = `py-2 px-4 mx-1 rounded-t-lg transition-colors duration-300 ${activeCategory === category ? 'tab-active' : 'hover:bg-gray-100'}`;
                tab.onclick = () => selectCategory(category);
                categoryTabsContainer.appendChild(tab);
            });
        }

        function selectCategory(category) {
            activeCategory = category;
            activePattern = null; // Reset active pattern when category changes
            renderTabs();
            renderPatternsList();
            renderPatternDetails(); // Will show category description
        }

        function renderPatternsList() {
            patternsListContainer.innerHTML = '';
            if (!activeCategory) return;

            const patterns = designPatternsData[activeCategory].patterns;
            const ul = document.createElement('ul');
            Object.keys(patterns).forEach(patternName => {
                const li = document.createElement('li');
                const button = document.createElement('button');
                button.textContent = patternName;
                button.className = `w-full text-right p-3 rounded-md transition-colors duration-200 ${activePattern === patternName ? 'pattern-active font-bold' : 'hover:bg-gray-50'}`;
                button.onclick = () => selectPattern(patternName);
                li.appendChild(button);
                ul.appendChild(li);
            });
            patternsListContainer.appendChild(ul);
        }

        function selectPattern(patternName) {
            activePattern = patternName;
            const common_uses = designPatternsData[activeCategory].patterns[activePattern]
            renderPatternsList();
            renderPatternDetails();
        }

        function renderPatternDetails() {
            patternDetailsContainer.innerHTML = '';

            if (!activeCategory) {
                 patternDetailsContainer.innerHTML = `<div class="flex items-center justify-center h-full bg-gray-50 rounded-lg p-8"><p class="text-gray-500 text-xl">اختر أحد الفئات لعرض التفاصيل.</p></div>`;
                return;
            }
            
            if (!activePattern) {
                const categoryData = designPatternsData[activeCategory];
                patternDetailsContainer.innerHTML = `
                    <div class="p-6 bg-gray-50 rounded-lg">
                        <h2 class="text-2xl font-bold mb-3">${activeCategory}</h2>
                        <p class="text-lg">${categoryData.description}</p>
                        <p class="mt-4 text-gray-500">اختر أحد الأنماط من القائمة على اليمين للبدء.</p>
                    </div>
                `;
                return;
            }

            const patternData = designPatternsData[activeCategory].patterns[activePattern];
            const content = `
                <div class="p-1 md:p-6">
                    <h3 class="text-3xl font-bold text-[#A47C57] mb-4">${activePattern}</h3>
                    <div class="mb-6">
                        <h4 class="font-bold text-xl mb-2 border-b-2 border-[#EFEBE5] pb-1">الفكرة</h4>
                        <p class="text-gray-700">${patternData.idea}</p>
                    </div>
                    <div class="mb-6">
                        <h4 class="font-bold text-xl mb-2 border-b-2 border-[#EFEBE5] pb-1">متى تستخدمه؟</h4>
                        <ul class="text-gray-700">${patternData.use_cases.map((_case) => `<li>${_case}</li>`).join('')}</ul>
                    </div>
                    <div>
                        <h4 class="font-bold text-xl mb-2 border-b-2 border-[#EFEBE5] pb-1">مثال تفاعلي</h4>
                        <div class="interactive-box p-6 rounded-lg mt-4 bg-white">
                            ${patternData.interactive_html}
                        </div>
                    </div>
                </div>
            `;
            console.log(patternData.common_uses);
            patternDetailsContainer.innerHTML = content;
            if (patternData.interactive_js) {
                patternData.interactive_js();
            }

            
        }

        // Initial render
        renderTabs();
    </script>
</body>
</html>
